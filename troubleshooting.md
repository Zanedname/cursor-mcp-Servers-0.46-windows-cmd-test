# Cursor MCP Servers 故障排除指南

本文档提供了在Windows环境下配置和使用Cursor MCP Servers时可能遇到的常见问题及其解决方案。

## 目录

- [服务器状态问题](#服务器状态问题)
- [工具不可用问题](#工具不可用问题)
- [Windows特有问题](#windows特有问题)
- [配置文件问题](#配置文件问题)
- [Node.js相关问题](#nodejs相关问题)
- [API密钥问题](#api密钥问题)
- [高级故障排除](#高级故障排除)

## 服务器状态问题

### 服务器状态显示为黄色

**症状**: MCP服务器状态指示器显示为黄色。

**解决方案**:
1. 点击服务器旁边的刷新按钮
2. 检查命令是否正确
3. 确保所有依赖项都已安装
4. 重启Cursor IDE

### 服务器状态显示为红色

**症状**: MCP服务器状态指示器显示为红色。

**解决方案**:
1. 检查命令是否正确
2. 在终端中手动运行命令，查看错误信息
3. 确保Node.js版本兼容(v18+)
4. 检查网络连接
5. 检查防火墙设置

### 服务器启动后立即关闭

**症状**: 服务器似乎启动了，但立即关闭，状态变为红色。

**解决方案**:
1. 检查命令语法
2. 确保所有必要的环境变量都已设置
3. 检查依赖项是否正确安装
4. 尝试在Git Bash而非CMD中运行

## 工具不可用问题

### AI助手无法识别MCP工具

**症状**: 即使服务器状态为绿色，AI助手也无法识别或使用MCP工具。

**解决方案**:
1. 确保在Composer或Agent模式下使用
2. 明确指示AI使用特定的MCP工具
3. 重新启动对话
4. 重启Cursor IDE

### 工具执行失败

**症状**: AI助手尝试使用工具，但执行失败。

**解决方案**:
1. 检查工具所需的权限
2. 确保工具所需的所有参数都已提供
3. 检查网络连接
4. 查看终端窗口中的错误信息

## Windows特有问题

### 权限问题

**症状**: 服务器无法启动，或工具无法访问系统资源。

**解决方案**:
1. 以管理员身份运行终端
2. 检查Windows防火墙设置
3. 确保Node.js有足够的权限
4. 检查文件路径是否包含特殊字符或空格

### 路径问题

**症状**: 服务器无法找到文件或目录。

**解决方案**:
1. 使用正斜杠(/)而非反斜杠(\\)
2. 避免路径中的空格，或使用引号包围路径
3. 确保路径长度不超过Windows限制

### 环境变量问题

**症状**: 服务器无法访问环境变量。

**解决方案**:
1. 在PowerShell中使用`$env:VARIABLE_NAME="value"`
2. 在CMD中使用`set VARIABLE_NAME=value`
3. 使用系统环境变量设置
4. 重启终端或IDE以应用新的环境变量

## 配置文件问题

### 项目级配置文件不起作用

**症状**: `.cursor/mcp.json`文件被忽略。

**解决方案**:
1. 这是Windows环境中的已知问题
2. 尝试使用全局配置文件
3. 通过设置界面手动添加服务器
4. 确保JSON格式正确

### JSON格式错误

**症状**: 配置文件无法加载。

**解决方案**:
1. 使用JSON验证工具检查格式
2. 确保所有引号都是英文引号
3. 检查逗号使用是否正确
4. 确保没有尾随逗号

## Node.js相关问题

### 版本兼容性

**症状**: 服务器无法启动，报告Node.js版本错误。

**解决方案**:
1. 使用`node -v`检查当前版本
2. 使用`nvm`安装并切换到兼容版本：
   ```
   nvm install 18
   nvm use 18
   ```
3. 如果没有`nvm`，下载并安装Node.js v18或更高版本

### 依赖项问题

**症状**: 服务器报告缺少依赖项。

**解决方案**:
1. 使用`npx`自动安装依赖项
2. 手动安装所需包：`npm install -g package-name`
3. 检查`npm`缓存：`npm cache clean --force`

## API密钥问题

### API密钥无效

**症状**: 需要API密钥的服务器报告认证错误。

**解决方案**:
1. 检查API密钥是否正确
2. 确保API密钥已正确设置为环境变量
3. 检查API密钥是否过期
4. 确认API密钥有足够的权限

### API密钥格式问题

**症状**: 服务器无法识别API密钥。

**解决方案**:
1. 确保没有额外的空格或换行符
2. 检查API密钥格式是否符合要求
3. 尝试重新生成API密钥

## 高级故障排除

### 查看详细日志

要获取更详细的错误信息：

1. 在终端中手动运行MCP服务器命令
2. 添加调试标志（如果支持）：`DEBUG=* npx -y @package/server-name`
3. 检查Cursor日志文件（通常在`%APPDATA%\Cursor\logs`）

### 网络问题排查

如果怀疑是网络问题：

1. 检查防火墙设置
2. 确保没有代理干扰
3. 尝试禁用VPN
4. 检查DNS设置

### 清理和重置

如果所有方法都失败：

1. 卸载并重新安装Node.js
2. 清理npm缓存：`npm cache clean --force`
3. 删除并重新创建MCP服务器配置
4. 重新安装Cursor IDE

## 获取帮助

如果以上方法都无法解决问题：

1. 访问[Cursor社区论坛](https://forum.cursor.com)
2. 查阅[官方MCP文档](https://cursor.sh/docs/mcp)
3. 在GitHub上提交问题
4. 联系Cursor支持团队

---

希望本指南能帮助你解决在使用Cursor MCP Servers时遇到的问题。如有任何补充或更正，欢迎提交贡献。